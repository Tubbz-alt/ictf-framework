input {
  udp {
    port => 1717
  }
}

filter {
  mutate {
    gsub => ["message", "\x1B\[([0-9]{1,2}(;[0-9]{1,2})?)?[m|K]", ""]
    add_field => { "logstash_host" => "%{host}" }
  }
  json {
    source => "message"
  }
}

output {
  elasticsearch {
    hosts => ["logger.ictf:9200"]
    index => "ictf-gamebot"
  }
}